import{c as m,x as i,h as p,e as k,i as P,k as C,f as d,j as _,B as b}from"./index-Cz0sLFk-.js";const A=()=>{const e=m.c(10),{user:o,paymentMethod:r,address:s}=i(),a=p(x);let c;e[0]!==s||e[1]!==a||e[2]!==r||e[3]!==o?(c={mutationFn:async()=>{const{completed:u,...l}=o,{completed:h,...f}=r,{completed:$,...y}=s;return(await P.post("purchase",{user:l,paymentMethod:f,address:y,products:a})).data}},e[0]=s,e[1]=a,e[2]=r,e[3]=o,e[4]=c):c=e[4];const t=k(c);let n;return e[5]!==t.data||e[6]!==t.error||e[7]!==t.mutateAsync||e[8]!==t.status?(n={setOrderAction:t.mutateAsync,submitedOrder:t.data,errorOnSubmitOrder:t.error,orderSubmitStatus:t.status},e[5]=t.data,e[6]=t.error,e[7]=t.mutateAsync,e[8]=t.status,e[9]=n):n=e[9],n};function x(e){return e.basketProducts}const M=()=>{const e=m.c(9),o=C(),{setOrderAction:r}=A(),s=i(O),a=p(S),c=i(B);let t;e[0]!==a||e[1]!==s||e[2]!==c||e[3]!==o||e[4]!==r?(t=async()=>{if(!c){d.error("Please complete all the steps");return}try{const{id:l}=await r();d.success("Purchase completed successfully"),s(),a(),o(`/success/${l}`)}catch(l){console.error("Purchase error:",l),d.error("Purchase failed. Try again.")}},e[0]=a,e[1]=s,e[2]=c,e[3]=o,e[4]=r,e[5]=t):t=e[5];const n=t;let u;return e[6]!==n||e[7]!==c?(u={isCheckoutComplete:c,handlePurchase:n},e[6]=n,e[7]=c,e[8]=u):u=e[8],u};function O(e){return e.clearCheckout}function S(e){return e.clearBasket}function B(e){return e.user.completed&&e.address.completed&&e.paymentMethod.completed}const v=()=>{const e=m.c(2),{isCheckoutComplete:o,handlePurchase:r}=M();if(!o)return null;let s;return e[0]!==r?(s=_.jsx(b,{type:"button",onClick:r,children:"Purchase"}),e[0]=r,e[1]=s):s=e[1],s};export{v as default};
